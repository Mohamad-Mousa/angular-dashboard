<section class="profile-view card border-0 shadow-sm">
  <div class="profile-cover"></div>
  <div class="profile-body p-4 p-md-5">
    <div class="d-flex flex-column flex-md-row gap-4 align-items-center align-items-md-start">
      <div class="avatar-wrapper">
        <div class="avatar">
          <img [src]="profile.image" [alt]="profile.firstName + ' ' + profile.lastName" class="img-fluid" />
        </div>
        <span class="status-pill">Active</span>
      </div>

      <div class="flex-grow-1">
        <header
          class="d-flex flex-column flex-md-row gap-2 align-items-center align-items-md-start justify-content-between">
          <div>
            <div class="d-flex flex-wrap align-items-center gap-2 mb-1">
              <h2 class="mb-0">
                {{ profile.firstName }} {{ profile.lastName }}
              </h2>
              <button type="button" class="edit-btn material-symbols-rounded" (click)="openEditDialog()">
                edit
              </button>
            </div>
            <p class="text-muted mb-2">{{ profile.title }}</p>
            <a class="email-link" [href]="'mailto:' + profile.email">
              {{ profile.email }}
            </a>
          </div>
          <div class="badge bg-primary-subtle text-primary-emphasis px-3 py-2 rounded-pill text-uppercase fw-semibold">
            Super Admin
          </div>
        </header>

        <p class="profile-bio mt-3 mb-4">
          {{ profile.bio }}
        </p>

        <div class="info-grid">
          <div>
            <p class="label">First name</p>
            <p class="value">{{ profile.firstName }}</p>
          </div>
          <div>
            <p class="label">Last name</p>
            <p class="value">{{ profile.lastName }}</p>
          </div>
          <div>
            <p class="label">Email</p>
            <p class="value">{{ profile.email }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<app-dialog [open]="isEditDialogOpen" title="Edit profile"
  description="Update your personal details for other admins to reference." width="560px" (closed)="closeEditDialog()">
  <form dialog-body [formGroup]="profileForm" class="profile-form">
    <div class="image-field">
      <app-image-upload label="Avatar" hint="PNG or JPG up to 5MB" [value]="profileForm.get('image')?.value"
        (valueChange)="onImageChange($event)" [disabled]="profileForm.disabled" shape="round"></app-image-upload>
      @if (profileForm.get('image')?.invalid && profileForm.get('image')?.touched) {
      <small class="error-text">Avatar is required.</small>
      }
    </div>
    <label>
      <span>First name</span>
      <input type="text" formControlName="firstName" />
    </label>
    <label>
      <span>Last name</span>
      <input type="text" formControlName="lastName" />
    </label>
    <label>
      <span>Email</span>
      <input type="email" formControlName="email" />
    </label>
    <label>
      <span>Title</span>
      <input type="text" formControlName="title" />
    </label>
    <label>
      <span>Bio</span>
      <textarea rows="3" formControlName="bio"></textarea>
    </label>
  </form>

  <div dialog-footer>
    <button type="button" class="btn-text" (click)="closeEditDialog()">
      Cancel
    </button>
    <button type="button" class="btn-primary" (click)="saveProfile()">
      Save changes
    </button>
  </div>
</app-dialog>